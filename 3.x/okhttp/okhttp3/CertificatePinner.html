<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_45) on Wed Jan 13 14:14:33 PST 2016 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>CertificatePinner (OkHttp 3.0.0 API)</title>
<meta name="date" content="2016-01-13">
<link rel="stylesheet" type="text/css" href="../stylesheet.css" title="Style">
<script type="text/javascript" src="../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="CertificatePinner (OkHttp 3.0.0 API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":42,"i1":10,"i2":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"],32:["t6","Deprecated Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../okhttp3/package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/CertificatePinner.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-all.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../okhttp3/Callback.html" title="interface in okhttp3"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../okhttp3/CertificatePinner.Builder.html" title="class in okhttp3"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../index.html?okhttp3/CertificatePinner.html" target="_top">Frames</a></li>
<li><a href="CertificatePinner.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">okhttp3</div>
<h2 title="Class CertificatePinner" class="title">Class CertificatePinner</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>okhttp3.CertificatePinner</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public final class <span class="typeNameLabel">CertificatePinner</span>
extends java.lang.Object</pre>
<div class="block">Constrains which certificates are trusted. Pinning certificates defends against attacks on
 certificate authorities. It also prevents connections through man-in-the-middle certificate
 authorities either known or unknown to the application's user.

 <p>This class currently pins a certificate's Subject Public Key Info as described on <a
 href="http://goo.gl/AIx3e5">Adam Langley's Weblog</a>. Pins are base-64 SHA-1 hashes, consistent
 with the format Chromium uses for <a href="http://goo.gl/XDh6je">static certificates</a>. See
 Chromium's <a href="http://goo.gl/4CCnGs">pinsets</a> for hostnames that are pinned in that
 browser.

 <h3>Setting up Certificate Pinning</h3>

 <p>The easiest way to pin a host is turn on pinning with a broken configuration and read the
 expected configuration when the connection fails. Be sure to do this on a trusted network, and
 without man-in-the-middle tools like <a href="http://charlesproxy.com">Charles</a> or <a
 href="http://fiddlertool.com">Fiddler</a>.

 <p>For example, to pin <code>https://publicobject.com</code>, start with a broken
 configuration: <pre>   <code>

     String hostname = "publicobject.com";
     CertificatePinner certificatePinner = new CertificatePinner.Builder()
         .add(hostname, "sha1/AAAAAAAAAAAAAAAAAAAAAAAAAAA=")
         .build();
     OkHttpClient client = new OkHttpClient();
     client.setCertificatePinner(certificatePinner);

     Request request = new Request.Builder()
         .url("https://" + hostname)
         .build();
     client.newCall(request).execute();
 </code></pre>

 As expected, this fails with a certificate pinning exception: <pre>   <code>

 javax.net.ssl.SSLPeerUnverifiedException: Certificate pinning failure!
   Peer certificate chain:
     sha1/DmxUShsZuNiqPQsX2Oi9uv2sCnw=: CN=publicobject.com, OU=PositiveSSL
     sha1/SXxoaOSEzPC6BgGmxAt/EAcsajw=: CN=COMODO RSA Domain Validation Secure Server CA
     sha1/blhOM3W9V/bVQhsWAcLYwPU6n24=: CN=COMODO RSA Certification Authority
     sha1/T5x9IXmcrQ7YuQxXnxoCmeeQ84c=: CN=AddTrust External CA Root
   Pinned certificates for publicobject.com:
     sha1/AAAAAAAAAAAAAAAAAAAAAAAAAAA=
   at okhttp3.CertificatePinner.check(CertificatePinner.java)
   at okhttp3.Connection.upgradeToTls(Connection.java)
   at okhttp3.Connection.connect(Connection.java)
   at okhttp3.Connection.connectAndSetOwner(Connection.java)
 </code></pre>

 Follow up by pasting the public key hashes from the exception into the
 certificate pinner's configuration: <pre>   <code>

     CertificatePinner certificatePinner = new CertificatePinner.Builder()
       .add("publicobject.com", "sha1/DmxUShsZuNiqPQsX2Oi9uv2sCnw=")
       .add("publicobject.com", "sha1/SXxoaOSEzPC6BgGmxAt/EAcsajw=")
       .add("publicobject.com", "sha1/blhOM3W9V/bVQhsWAcLYwPU6n24=")
       .add("publicobject.com", "sha1/T5x9IXmcrQ7YuQxXnxoCmeeQ84c=")
       .build();
 </code></pre>

 Pinning is per-hostname and/or per-wildcard pattern. To pin both <code>publicobject.com</code> and
 <code>www.publicobject.com</code>, you must configure both hostnames.

 <p>Wildcard pattern rules:
 <ol>
     <li>Asterisk <code>*</code> is only permitted in the left-most domain name label and must be the
         only character in that label (i.e., must match the whole left-most label). For example,
         <code>*.example.com</code> is permitted, while <code>*a.example.com</code>, <code>a*.example.com</code>,
         <code>a*b.example.com</code>, <code>a.*.example.com</code> are not permitted.
     <li>Asterisk <code>*</code> cannot match across domain name labels. For example,
         <code>*.example.com</code> matches <code>test.example.com</code> but does not match
         <code>sub.test.example.com</code>.
     <li>Wildcard patterns for single-label domain names are not permitted.
 </ol>

 If hostname pinned directly and via wildcard pattern, both direct and wildcard pins will be used.
 For example: <code>*.example.com</code> pinned with <code>pin1</code> and <code>a.example.com</code> pinned with
 <code>pin2</code>, to check <code>a.example.com</code> both <code>pin1</code> and <code>pin2</code> will be used.

 <h3>Warning: Certificate Pinning is Dangerous!</h3>

 <p>Pinning certificates limits your server team's abilities to update their TLS certificates. By
 pinning certificates, you take on additional operational complexity and limit your ability to
 migrate between certificate authorities. Do not use certificate pinning without the blessing of
 your server's TLS administrator!

 <h4>Note about self-signed certificates</h4>

 <p><a href="../okhttp3/CertificatePinner.html" title="class in okhttp3"><code>CertificatePinner</code></a> can not be used to pin self-signed certificate if such certificate
 is not accepted by <code>TrustManager</code>.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning"> OWASP:
 Certificate and Public Key Pinning</a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../okhttp3/CertificatePinner.Builder.html" title="class in okhttp3">CertificatePinner.Builder</a></span></code>
<div class="block">Builds a configured certificate pinner.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static <a href="../okhttp3/CertificatePinner.html" title="class in okhttp3">CertificatePinner</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../okhttp3/CertificatePinner.html#DEFAULT">DEFAULT</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t6" class="tableTab"><span><a href="javascript:show(32);">Deprecated Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../okhttp3/CertificatePinner.html#check-java.lang.String-java.security.cert.Certificate...-">check</a></span>(java.lang.String&nbsp;hostname,
     java.security.cert.Certificate...&nbsp;peerCertificates)</code>
<div class="block"><span class="deprecatedLabel">Deprecated.</span>&nbsp;
<div class="block"><span class="deprecationComment">replaced with <a href="../okhttp3/CertificatePinner.html#check-java.lang.String-java.util.List-"><code>check(String, List)</code></a>.</span></div>
</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../okhttp3/CertificatePinner.html#check-java.lang.String-java.util.List-">check</a></span>(java.lang.String&nbsp;hostname,
     java.util.List&lt;java.security.cert.Certificate&gt;&nbsp;peerCertificates)</code>
<div class="block">Confirms that at least one of the certificates pinned for <code>hostname</code> is in <code>peerCertificates</code>.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../okhttp3/CertificatePinner.html#pin-java.security.cert.Certificate-">pin</a></span>(java.security.cert.Certificate&nbsp;certificate)</code>
<div class="block">Returns the SHA-1 of <code>certificate</code>'s public key.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="DEFAULT">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>DEFAULT</h4>
<pre>public static final&nbsp;<a href="../okhttp3/CertificatePinner.html" title="class in okhttp3">CertificatePinner</a> DEFAULT</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="check-java.lang.String-java.util.List-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>check</h4>
<pre>public&nbsp;void&nbsp;check(java.lang.String&nbsp;hostname,
                  java.util.List&lt;java.security.cert.Certificate&gt;&nbsp;peerCertificates)
           throws javax.net.ssl.SSLPeerUnverifiedException</pre>
<div class="block">Confirms that at least one of the certificates pinned for <code>hostname</code> is in <code>peerCertificates</code>. Does nothing if there are no certificates pinned for <code>hostname</code>.
 OkHttp calls this after a successful TLS handshake, but before the connection is used.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>javax.net.ssl.SSLPeerUnverifiedException</code> - if <code>peerCertificates</code> don't match the certificates
 pinned for <code>hostname</code>.</dd>
</dl>
</li>
</ul>
<a name="check-java.lang.String-java.security.cert.Certificate...-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>check</h4>
<pre>public&nbsp;void&nbsp;check(java.lang.String&nbsp;hostname,
                  java.security.cert.Certificate...&nbsp;peerCertificates)
           throws javax.net.ssl.SSLPeerUnverifiedException</pre>
<div class="block"><span class="deprecatedLabel">Deprecated.</span>&nbsp;<span class="deprecationComment">replaced with <a href="../okhttp3/CertificatePinner.html#check-java.lang.String-java.util.List-"><code>check(String, List)</code></a>.</span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>javax.net.ssl.SSLPeerUnverifiedException</code></dd>
</dl>
</li>
</ul>
<a name="pin-java.security.cert.Certificate-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>pin</h4>
<pre>public static&nbsp;java.lang.String&nbsp;pin(java.security.cert.Certificate&nbsp;certificate)</pre>
<div class="block">Returns the SHA-1 of <code>certificate</code>'s public key. This uses the mechanism Moxie
 Marlinspike describes in <a href="https://github.com/moxie0/AndroidPinning">Android
 Pinning</a>.</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../okhttp3/package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/CertificatePinner.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-all.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../okhttp3/Callback.html" title="interface in okhttp3"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../okhttp3/CertificatePinner.Builder.html" title="class in okhttp3"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../index.html?okhttp3/CertificatePinner.html" target="_top">Frames</a></li>
<li><a href="CertificatePinner.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2016. All Rights Reserved.</small></p>
</body>
</html>
